---
title: "Batter Performance in Out of the Park Baseball"
author: "Eric DuBose"
date: "October 15th, 2018"
output: html_document
editor_options: 
  chunk_output_type: console
---

```{r echo=FALSE, message=FALSE, warning=FALSE}
library(dbplyr) # Loading dbplyr to help mold and manipulate data
library(ggplot2) # Loading GGplot2 to provide data visualizations
library(knitr) # Loading Knitr to knit HTML to convey our report in HTML format
library(dplyr) # Loading Dplyr for manipulation
library(ggcorrplot) # Loading for Correlation Plots
library(ggpubr) # Loading for stat_cor
```

```{r global_options, include=FALSE}
knitr::opts_chunk$set(echo=FALSE, warning=FALSE, message=FALSE)
```

```{r Loading the Data, echo=FALSE}
ootp <- read.csv("sbc.csv", fileEncoding="UTF-8-BOM") # Import CSV file
```

Baseball is a complicated sport. From the high school level around the world,
to the pros at the highest level of performance, fans try to enjoy the game at
both the most basic level, as well as the intricate complexities that this game
brings to to proverbial table. 

This game, is one of those intricate complexities. Out of the Park Baseball is 
a simulation game, that uses an engine that accurately projects, and simulates
baseball at every level of the game, from Rookie Ball, all the way to the Major
Leagues. The program has a tremendous depth to it, which motivated me to further
investigate the data that this wonderful game can present. My goal today, is to 
not only see what simulated statistics look like, but also see if we can find 
relationships between variables that may provide us the ability to project
or even predict a player's batting performance, based on simulated ratings. 
There are a few statistics for sampling that I would like to summarize, and 
clarify before we begin our analysis. 

I Simulated 10 full seasons at the Major League level in game. Next, I Pulled 
every batter that had 200 Plate Appearances minimum. The reasoning for this is
to mitigate skewed data, simply as 200 plate appearances is a good convergence
point for the accuracy desired. There will be what may appear to be duplicate 
players, but only due to multiple seasons for each player in the dataset. We 
aren't seeking individual performance to provide rankings, moreso the data 
themselves. The names are simply inclusive for arbitrary record control. Once 
completed, I exported from the game a CSV File that was generated by OOTP. 
There was no additional data wrangling required, as the preselection process
ensured that I would have clean data to utilize. I will confirm this with my 
analysis below.

```{r Are any cells empty or null?}
any(is.na(ootp)) # Checks to confirm any cells are empty or null
```

Fortunatley, we confirm that there are no NA values, which will ensure that we
can utilize the data without further cleaning at this time being required.

Here is a list of all variables that our dataset includes.

```{r Column Names}
colnames(ootp) # Lists all names of columns
```

# Univariate Plots Section

I want to start by looking at 4 primary categories that fans in general take a 
look at when analyzing a baseball player. Average, On Base Percentage, Slugging
Percentage and WAR. Additionally, I want to look at the 5 primary "tools", 
which are ratings that each player is scored by to determine their batting
skills. These, are Contact, Gap, Power, Eye, and Avoid K. I will discuss each 
rating more in depth with each graph.

Additionally, I prefer to use the Freedman-Diaconis rule for calculating my bin
width. Before I begin with this process, I would like to first set a bin and bin
width variable to integrate into my histograms to best describe the data we are
looking at. With 3,056 observations, It's crucial we get this right to properly
view our data.

```{r Batting Average (AVG), echo=FALSE}
# Setting Bin Width
averagebw <- (2 * IQR(ootp$Average) / length(ootp$Average)^(1/3)) 
# Setting Average Bin Size 
averagebin <- (max(ootp$Average) - min(ootp$Average))
# Create a Plot in GGPlot
average_plot <- ggplot(ootp, aes(x = Average)) +
  # Create a Histogram, setting the Binwidth, bins, and athstetics
  geom_histogram(binwidth = averagebw, bins = averagebin, aes(
  fill =..count..)) + 
  # Setting labels for the graph
  labs(x = "Average", 
       y = "Counts", 
       title = "Averages of all 1675 batters", 
       subtitle = "Data from OOTP 19")

average_plot
```

Average, is the most standard, universally accepted measure of a player's 
performance in baseball. Simply stated, average represents the number of times 
a player gets a hit divided by the number of times they are scored with an "At 
Bat". Note, this does not inclulde times where the player gets hit by a pitch, 
is walked, hits a sacrifice fly/bunt, catcher interference, or if the inning
ends while he is still at bat. 


```{r AVG Summary Stats, echo=FALSE}
summary(ootp$Average) # The summary statistics
```


Our dataset includes aa wide range of averages, but most consistently, the 
averages are centered at .2581 as the mean, and .2580 as the median. The 
distribution is distributed normally. 


*** 

```{r Work Ethic, echo=FALSE}
# Create a Plot in GGPlot
work_ethic_plot <- ggplot(ootp, aes(x = Work.Ethic)) +
  # Create a Histogram, setting the Binwidth, bins, and athstetics
  geom_histogram(stat="count", aes(fill =..count..)) + 
  # Setting labels for the graph
  labs(x = "Work Ethic", 
       y = "Counts", 
       title = "Work Ethic of all 1675 batters", 
       subtitle = "Data from OOTP 19")

work_ethic_plot
```

We have a clear seperation in the amount of batters that have a varying level of work ethic. This could be useful in differentiating the quality of a player, or potentially improving the analytics utilized.

***

```{r On Base Percentage (OBP), echo=FALSE}
# Setting Bin Width
obpbw <- (2 * IQR(ootp$On.Base.Pct) / 
  length(ootp$On.Base.Pct)^(1/3))
# Setting Average Bin Size
obpbin <- (max(ootp$On.Base.Pct) - min(ootp$On.Base.Pct))
# Create a Plot in GGPlot
obp_plot <- ggplot(ootp, aes(x = On.Base.Pct)) +
  # Create a Histogram, setting the Binwidth, bins, and athstetics
  geom_histogram(binwidth = obpbw, breaks = seq(.2,.45,.01), aes(
  fill =..count..),show.legend = FALSE) + 
  # Setting labels for the graph
  labs(x = "On Base Percentage", 
       y = "Counts", 
       title = "On Base Percentages of all 1675 batters", 
       subtitle = "Data from OOTP 19")
obp_plot
```


On Base Percentage, captures hits, but also includes walks, hit by pitch, and 
intentional walks. This often captures the player's ability to draw walks, and 
get on base more than just when a player gets a hit. Looking deeply into the 
data, we can see that most players fall between getting on base 30-35% of the
time. Incidentally, it appears that rarer values range below 25%, and above 40%.
The data is normally distributed, but appears to have a much more centralized 
peak. 

```{r OBP Summary Stats, echo=FALSE}
summary(ootp$On.Base.Pct)# The summary statistics
```

The median roughly equals the mean, confirming my thoughts about the 
distribution. The quartiles also support some of my inital evaluations about the
rarity of the data. 

*** 

```{r Slugging Percentage (SLG), echo=FALSE}
# Setting Bin Width
slgbw <- (2 * IQR(ootp$Slugging.Pct) / length(ootp$Slugging.Pct)^(1/3))
# Setting Average Bin Size
slgbin <- (max(ootp$Slugging.Pct) - min(ootp$Slugging.Pct))
# Create a Plot in GGPlot
slg_plot <- ggplot(ootp, aes(x = Slugging.Pct)) +
  # Create a Histogram, setting the Binwidth, bins, and athstetics
  geom_histogram(binwidth = slgbw, bins = slgbin, aes(fill = ..count..),
       show.legend = FALSE) + 
  # Setting labels for the graph
  labs(x = "Slugging", 
       y = "Counts", 
       title = "Slugging of all 1675 batters", 
       subtitle = "Data from OOTP 19")

slg_plot
```


Slugging Percentage is a bit confusing to most people. Essentially it assigns a
value to bases, and calculates the value of the hits that players get. A single
is worth 1, a double worth 2, triple worth 3, and homerun worth 4. Once summed, 
we then divide it by the total number of at bats. To summarize contextually, a
batter with a slugging percentage of .500, essentially tells us that the number
of bases per at bat he will gain on average, is .5. Or another way, we can
expect him to hit 1st base once every two at bats, and second base once every 
four at bats.

Like Average, On Base Percentage, this distribution appears to be normal, yet
it does appear to skew slightly to the right. 

```{r SLG Summary Stats, echo=FALSE}
summary(ootp$Slugging.Pct) # The summary statistics
```

Once again, the median and mean are very close, confirming a normal distribution
and also confirming a very tiny skew to the right. 

*** 

```{r Wins Above Replacement(WAR), echo=FALSE}
# Setting Bin Width
warbw <- (2 * IQR(ootp$WAR) / length(ootp$WAR)^(1/3))
# Setting Average Bin Size
warbin <- (max(ootp$WAR) - min(ootp$WAR))
# Create a Plot in GGPlot
war_plot <- ggplot(ootp, aes(x = WAR)) +
  # Create a Histogram, setting the Binwidth, bins, and athstetics
  geom_histogram(binwidth = warbw, bins = warbin, aes(fill = ..count..),
       show.legend = FALSE) + 
  # Setting labels for the graph
  labs(x = "WAR", 
       y = "Counts", 
       title = "WAR of all 1675 batters", 
       subtitle = "Data from OOTP 19")

war_plot
```


WAR Is the first distribution that we have come across that isn't close to 
normally distributed visually. We have some extreme values to the right, and 
heavy skew to the right. WAR is interesting and very comprehensive. WAR stands
for Wins Above Replacement. Essentially, a player's WAR is how many more wins 
they will earn their team over the league average replacement level player. So 
if John has a war of 4, he will give his team 4 more wins than an average guy.

War is designed to bring all factors together, including hitting, defense, and
every metric possible. The goal is to break down a player to a singular stat
to define their value. It's widely accepted, but not perfect. Here, we may need
to do some further analysis to see if outliers exist.

```{r WAR Summary Stats, echo=FALSE}
summary(ootp$WAR) # The summary statistics
```

The large amount of data occurs between 1 and 2 WAR. Notice how the mean and 
median differ by a decent amount? This confirms the skew we referred to, but it
might not be as dramatic as I expected before. 

***

Ratings are what OOTP 19 gives to a player, and Contact is the first rating. 
This is a discrete variable, ranging from 0-20, with 20 being the maximum of the
game's arbitrary scale.

```{r Contact Ratings(CON), echo=FALSE}
# Create a Plot in GGPlot
con_plot <- ggplot(ootp, aes(x = Contact)) +
  # Create a Histogram, setting the Binwidth, bins, and athstetics
  geom_histogram(breaks = seq(5,20, 1), aes(fill = ..count..),
       show.legend = FALSE) + 
  # Setting labels for the graph
  labs(x = "Contact", 
       y = "Counts", 
       title = "Contact Ratings of all 1675 batters", 
       subtitle = "Data from OOTP 19")

con_plot
```

```{r CON Summary Stats, echo=FALSE}
summary(ootp$Contact) # The summary statistics
```

Contact is defined by OOTP as the rating that defines how well a player can get his bat onto the ball when pitched. Most ratings fall between 8 - 11, with the summary statistics listed above.

***


```{r Gap Power Ratings(GAP), echo=FALSE}
# Create a Plot in GGPlot
gap_plot <- ggplot(ootp, aes(x = Gap)) + 
  # Create a Histogram, setting the Binwidth, bins, and athstetics
  geom_histogram(breaks = seq(5,20, 1), aes(fill = ..count..),
       show.legend = FALSE) + 
  # Setting labels for the graph
  labs(x = "GAP Power", 
       y = "Counts", 
       title = "GAP Ratings of all 1675 batters", 
       subtitle = "Data from OOTP 19")
gap_plot 
```

```{r GAP Summary Stats, echo=FALSE}
summary(ootp$Gap)# The summary statistics
```

GAP Power essentially tells us how hard the player can hit line drives, and the gaps in the coverage defensively. GAP Power is often equated with the ability to hit doubles.

***

```{r Power Ratings(POW), echo=FALSE}
# Create a Plot in GGPlot
pow_plot <- ggplot(ootp, aes(x = Power)) +
  # Create a Histogram, setting the Binwidth, bins, and athstetics
  geom_histogram(breaks = seq(5,20, 1), aes(fill = ..count..),
       show.legend = FALSE) + 
  # Setting labels for the graph
  labs(x = "Power", 
       y = "Counts", 
       title = "Power Ratings of all 1675 batters", 
       subtitle = "Data from OOTP 19")

pow_plot
```


```{r POW Summary Stats, echo=FALSE}
summary(ootp$Power) # The summary statistics
```

Power tells us how likely a player is to hit the ball hard, far, and typically for homeruns. Generally speaking, the better the power, the more homeruns a player hits.

***

```{r Eye Ratings(EYE), echo=FALSE}
# Create a Plot in GGPlot
eye_plot <- ggplot(ootp, aes(x = Eye)) +
  #  Create a Histogram, setting the Binwidth, bins, and athstetics
  geom_histogram(breaks = seq(5,20, 1), aes(fill = ..count..),
       show.legend = FALSE) + 
  # Setting labels for the graph
  labs(x = "Eye", 
       y = "Counts", 
       title = "Eye Ratings of all 1675 batters", 
       subtitle = "Data from OOTP 19")
eye_plot 
```


```{r EYE Summary Stats, echo=FALSE}
summary(ootp$EYE) # The summary statistics
```

Eye rating tells us how well a player sees pitches. Typically speaking, Eye will essentially give us an idea about how well the player best gets on base, be it from walking, hitting, or other factors.

***

```{r Avoid Strikeouts Ratings(K), echo=FALSE}
# Create a Plot in GGPlot
k_plot <- ggplot(ootp, aes(x = K)) +
  # Create a Histogram, setting the Binwidth, bins, and athstetics
  geom_histogram(breaks = seq(5,20, 1), aes(fill = ..count..),
       show.legend = FALSE) + 
  # Setting labels for the graph
  labs(x = "Avoid Strikeouts", 
       y = "Counts", 
       title = "Avoid Strikeout Ratings of all 1675 batters", 
       subtitle = "Data from OOTP 19")

k_plot
```


```{r K Summary Stats, echo=FALSE}
summary(ootp$K) # The summary statistics
```

Avoid Strikeouts(K) is a metric that essentially tells us how good our player is at not striking out. There often can be more to it than that, but generally the expectation is that the higher this rating, the less times a batter will strikeout.

***

## Univariate Analysis

### What is the structure of your dataset?

The dataset has 1675 observations, and 27 variables.

### What is/are the main feature(s) of interest in your dataset?

The primary features of interest in this are each individual batter, and the listed variables we are investigating. The ultimate goal of this data

### What other features in the dataset do you think will help support your
investigation into your feature(s) of interest?

I believe relating the aforementioned values to the players actual statistical outputs that are related to that statisic could help us further develop understanding of the caliber of the relationships they have to each other.

### Did you create any new variables from existing variables in the dataset?

No new variables were created at this time.

### Of the features you investigated, were there any unusual distributions?
Did you perform any operations on the data to tidy, adjust, or change the form 
of the data? If so, why did you do this?

Nothing appeared unusual, other than some skew. Most data sets were normally distributed, minus Avoid Strikeout ratings, which appears to have a different distrbution. No transformation was required for the univariate analysis.


# Bivariate Plots Section

Before we begin investigating the bivariate nature of the relationships amongst the variables in this plot, I wanted to take a moment to create some subsets for us to look at initially. We will have 3 categories of Correlgrams. Slash Variables, which indicate a player's slash line. This means the batting average, on base percentage, and slugging percentage. In Baseball circles, this is often displayed as follows: ex (.310/.381/.481). Second, we will utilize player 
ratings coupled with their performance on the field, namely how many hits, extra base hits, homeruns, % of walks, and % of strikeouts. Finally, we will look at stats related to foot speed, including a player's defensive prowess, running speed, and how well they steal and run the bases.

```{r Bivariate Setup, echo=FALSE}
# Defining the columns we want to select for each grouping of type of statistic.

rating_slash_vars <- c("Contact", "Gap", "Power", "Eye", "K", "Average", "On.Base.Pct", "Slugging.Pct", "WAR")

rating_stats_vars <- c("Contact", "Gap", "Power", "Eye", "K", "Hits", "XBH", "Homeruns", "Walk.Pct", "Strikeout.Pct")

# Creating new subsets using the vector selection from the ootp dataset
slash_line <- subset(ootp, select = rating_slash_vars) 
stats_line <- subset(ootp, select = rating_stats_vars)

# Creating a correlation variable, set to two decimal places that gives us the R level, or linear correlation for each individual cell.
corr_slash <- round(cor(slash_line),2)
corr_stats <- round(cor(stats_line),2)
```

***

```{r Correlogram of Slashline, echo=FALSE}
# Setting the correlation plot for the listed variables. 
ggcorrplot(corr_slash,
           type = "upper", # Puts the plots in the upper left
           lab = TRUE, # Labels on
           lab_size = 3.5, # Size of the Labels
           method = "circle", # Type of lable, image
           # Colors of the range of R level
           colors = c("red", "white", "green"), 
           # Title
           title = "Correlogram of Ratings and Slash Line (AVG/OBP/SLG)",
           ggtheme = theme_bw) # Theme choice
```

Initially, I am seeking to find out if the 5 ratings (Contact, Gap, Eye, Power, and K) have a strong relationship with a player's slash line (Average/On Base Pct/Slugging Pct) as well as what rating most correlates to Wins Above Replacement. 

* Contact best correlates with Average, moderately strong. 
* Gap best correlates with Slugging Percent, but quite weakly.
* Power best correlates with Slugging Percent moderately.
* Eye correlates with On Base Percent, weakly.
* Avoid K correlates best with Average moderately.

Focusing on the slash line variables:

* Average best correlates with Contact
* On Base Percentage best correlates with Average
* Slugging Percentage best correlates with Average

This is unexpected, but intriguing. Since Average best appears to correlate to the other slash variables, I want to further explore how Contact correlates to Average, as it could be the driving force of a player's contribution to the
slash line. 

*** 

```{r Exploring Contact vs. Average, echo=FALSE}
# Create a Plot in GGPlot
cont_avg_plot <- ggplot(ootp, aes(x = Contact, y = Average)) + 
# Create a boxplot andd scatterplot, setting the Binwidth, bins, and athstetics
  geom_boxplot(aes(group = ootp$Contact)) + 
  # Setting labels for the graph
  labs(x = "Contact Ratings", 
       y = "Batting Averages", 
       title = "Scatterplot of Contact vs. Average", 
       subtitle = "Each Contact Rating's distribution is shown") +
       stat_cor(method = "pearson")

cont_avg_plot

```

We have contact ratings ranging from 5 through 21, but a very large amount of observations. I want to group them by rating, and use the mean and median of these groups to evaluate this relationship further. 


```{r Grouping by Contact Ratings, echo=FALSE, warning=FALSE}
cont_grouped <- group_by(ootp, Contact) # Setting data to group by
# Grouping by contact, and creating calculations for new columns
group_contact <- summarize(cont_grouped, count = n(), mean_avg = mean(Average, na.rm = TRUE), med_avg = median(Average, na.rm = TRUE))
group_contact
```

Upon seeing the groups, a few things stand out to me. For starters, we have very few observations for contact ratings that are low and high. I am going to 
exclude any observations with counts less than 50. This means our new limits are from a contact of 7 to a contact of 15.

```{r Exploring Contact vs. Average Part 2, echo=FALSE}
# Recalling the plot, adding a smoothing line and limiting the x-axis
cont_avg_plot +
  geom_smooth(method="lm", level=0.95) + 
  xlim(6.5, 15.5)
```

Unfortunately, notice our R decreased from .67 to .62. We don't want to weaken the strength of our linear relationship... so I will go ahead and put the initially dropped values back in, and re-evaluate.

```{r Exploring Contact vs. Average Part 3, echo=FALSE}
# Recalling the plot, but removing the X-axis limit. 
cont_avg_plot +
  geom_smooth(method="lm", level=0.95)

```

I considered transformations, but our data already has a linear relationship. At this point, it appears that we have a model that can predict average with contact, but it's not perfect. A few concerns: 

* Values <= 10, and Values >=15 appear to less accurate in the prediction. Our smoothing line appears to be quite accurate (Confidence Level 95%), and could potentially be a good predictor of the mean values of each contact rating. We
may have a bit more variability with predicting the average in each specific contact rating for a player, as each rating does appear to have a relatively 
wide range of outcomes for each level. This warrants further exploration in a more in depth project.

***

```{r Exploring Contact vs. Average Part 4, echo=FALSE}
# Setting Bin Width
avgbw <- (2 * IQR(ootp$Average) / length(ootp$Average)^(1/3)) 
# Setting Average Bin Size
avgbin <- (max(ootp$Average) - min(ootp$Average))
# Create a Plot in GGPlot
avg_plot <- ggplot(ootp, aes(x = Average)) +
  # Create a Histogram, setting the Binwidth, bins, and athstetics
  geom_histogram(binwidth = avgbw, bins = avgbin, aes(fill = ootp$Work.Ethic),
       show.legend = TRUE) + 
  # Setting labels for the graph
  labs(x = "Average", 
       y = "Counts", 
       title = "Averages of all 1675 batters", 
       subtitle = "Data from OOTP 19", 
       fill = "Work Ethic")

avg_plot
```

This graph gives me a belief that we should further investigate the breakdown of how Contact and Average relate based on Work Ethic. As this plot shows, there is considerable differentiation between the three measures of work ethic.


```{r Correlogram of Stats, echo=FALSE}
# Setting the correlation plot for the listed variables. 
ggcorrplot(corr_stats,
           type = "upper", # Puts the plots in the upper left
           lab = TRUE, # Labels on
           lab_size = 3.5, # Size of the Labels
           method = "circle", # Type of lable, image
           # Colors of the range of R level
           colors = c("red", "white", "green"), 
           # Title
           title = "Correlogram of Ratings and Slash Line (AVG/OBP/SLG)", 
           ggtheme = theme_bw) # Theme choice
```

In our second correlogram, I am relating Player Ratings and the actual outcomes of a player going to bat. Looking at the correlations, it appears that Homeruns correlate well to power, but even moreso, Walk Percentage has a .85 correlation coefficient with eye. 

I will investigate the breakdown of Eye vs. Walk Percentage through an 
individual scatterplot.


```{r Exploring Eye and Walk Percentage, echo=FALSE}
# Create a Plot in GGPlot
eye_walk_plot <- ggplot(ootp, aes(x = Eye, y = Walk.Pct)) + 
# Create a boxplot andd scatterplot, setting the Binwidth, bins, and athstetics
  geom_boxplot(aes(group = ootp$Eye)) + 
  # Setting labels for the graph
  labs(x = "Eye Ratings", 
     y = "Percentage of Walks per At Bats", 
     title = "Scatterplot of Eye vs. Walk Percentage", 
     subtitle = "Each Eye Rating's distribution is shown") +
   stat_cor(method = "pearson")


eye_walk_plot
```

Let's group once again to get the counts, means, and medians.

```{r Grouping by Eye Ratings, echo=FALSE}
eye_grouped <- group_by(ootp, Eye) # Setting data to group by
# Grouping by contact, and creating calculations for new columns
group_eye <- summarize(eye_grouped, count = n(), mean_avg = mean(Eye, na.rm = TRUE), med_avg = median(Eye, na.rm = TRUE))

group_eye
```

I am going to try to limit the data once again to see if it improves our model 
at all. I will look for any eye ratings where n < 50, and remove them. 

This will change the limit on the X-Axis to 7 through 16.

```{r Exploring Eye vs. Walk Percentage Part 2, echo=FALSE}
eye_walk_plot +
  geom_smooth(method="lm", level=0.95) + # adding a smoothing line
  xlim(6.5, 16.5) #Limiting X axis
```

Unfortunately, similarly to the last exploration between Contact and Average, 
the correlation coefficient dropped when we removed values. We will reinsert these in so that we get the best model that we can consider. Once again, we 
won't seek to transform this data, as they are already linearly related, and statistically significant as is to each other.

```{r Exploring Eye vs. Walk Percentage Part 3, echo=FALSE}
eye_walk_plot +
  geom_smooth(method="lm", level=0.95) 
```

This model shows some weakness in prediction for the mean eye rating when we are looking at certain values. When Eye < 7, and Eye > 16, the error rates seem to increases, and the line of best fit isn't nearly as accurate. We would need to further investigate if there is a better fitting model, possibly quadratic to capture the very outer edges more accurately.


***

Additionally, changing gears, I wanted to compare WAR to a player's Salary. This is a good metric to see exactly how valuable the player's contribution is, and how much the player costs. This can actually lead to finding real value, which would mean players that cost less, but provide a large number of wins above replacement.

```{r Comparison of WAR to Salary, echo=FALSE}
# Creating Plot
war_salary_plot <- ggplot(Catchers, aes(x = WAR, y = Salary.in.Millions)) +
  # Labels
  labs(x = "Wins Above Replacement", 
       y = "Salary in Millions USD", 
       title = "Wins Above Replacement vs. Salary", 
       subtitle = "Data from OOTP 19")
  #Annotations for corners of graph

war_salary_plot + geom_point()
```

Initially, some factors about this chart stand out. We have a lot of very low salary players, which is classified as league minimum salaries. It might be prudent to disregard those salaries, as their value is exceedingly low in cost already, and will not provide anything but hinderance to this analysis. Let's 
set a limit of 5 million salary, up to the highest, which is close to 50 
million. WAR, will have no limitation.

```{r Comparison of WAR to Salary Part 2, echo=FALSE}
war_salary_plot +
  geom_point() + 
  ylim(5,30)
  
```

The chart is looking a bit better, but at this point, we would be better suited to add some jitter to the points. They appear to be clustered and overplotted in certain locations. Let's add some alpha, height and width to the jitter to provide us a bit better insight to our data.

```{r Comparison of WAR to Salary Part 3, echo=FALSE}
war_salary_plot <- war_salary_plot + 
  ylim(5,50) + 
  geom_jitter(alpha = 1/3, height = .8, width = .8) # Jitter points, setting location of how much jitter comes into play

war_salary_plot
```

This plot, really breaks down how valuable a player is with respect to both Salary and Wins Above Replacement. As we approach the right side of the graph, value increases. Moving from bottom to top, value decreases, as players cost more. The graph indicates what each segment will mean. This graph will provide a decision maker a utility and framework for seeking out players who cost less, 
but can help win more. Notice that the player with the best WAR actually costs less than 15 Million, a definite bargain compared to some other guys. 

***


# Bivariate Analysis

### Summary of Relationships

I researched two of the stronger correlation relationships. Contact and Average for one. Eye and Walk Percent as the other. I noticed that both of these 
variable pairs could be used not just to evaluate them, but to potentially be utilized in a prediction model. Other statistics correlated very poorly, and would not be satisfactory to utilize in such a manner. Additionally, I noticed that with the size of this dataset, Discrete variables often had a wide range of variation in its own right, which needed to be accounted for and considered in prediction based thinking. The Prediction models themselves appear to be medium strength correlation to project a specific player's average or walk rate given Control or Eye... but the mean/median of each individual rating appeared to be very centric at a 95% confidence level.

### Did you observe any interesting relationships between the features?

WAR and Salary were a terrific comparison, but I found there to be a weak relationship as a whole, at least linearity wise. Comparitives showed that there are some great value guys, and very expensive guys who just find ways to lose. 

### What was the strongest relationship you found?

By far Walk Percentage to Eye. It correlated linearly with a coeffcient of .85. We could explain over 65% of the variation in Eye and Walk Percentage with this relationship.

# Multivariate Plots Section

We've established some relationships as noted above. What I would like to do is take a deeper look at how Work Ethic can apply to some of these variables that 
we looked at in the Bivariate Analysis. 


```{r Multivariate Contact vs. Average with Work Ethic, echo=FALSE}
# Creating Plot
cont_avg_we_plot <- ggplot(ootp, aes(x = Work.Ethic, y = Average)) + 
  # Boxplot and Scatterplot, with Contact as a factor.
  geom_boxplot(aes(fill = factor(ootp$Contact))) + 
  geom_smooth(method = lm) +
  # Labels
  labs(x = "Work Ethic Rating", 
       y = "Batting Averages", 
       title = "Scatterplot of Work Ethic vs. Average", 
       subtitle = "Each Contact Rating's distribution by work ethic is shown",
       fill = "Contact Rating")

cont_avg_we_plot


```

As we can see, there is a consistent trend in the data as we saw before, but it
is now a bit different than the inital bivariate graph showed. It appears that players with a high work ethic have a more consistent range of batting averages based on the contact rating. The players with high averages also seem to max out higher than the players in other work ethic ratings. The median of each contact rating appears to follow a consistent linear pattern as contact ratings 
increase.

Interestingly about the Low work ethic rating, there is a great deal more variation in the medians of the batting averages per contact rating. It appears that predicting a players batting average given low work ethic using their contact rating would be less reliable. 

Normal work ethic appears to be mostly similar to high work ethic, with a bit more variation from low to high averages. 

The consistent theme about the data, is that the medians appear as a whole to guide the line of best fit for future prediction.

***


```{r Multivariate Eye vs, Walk Percentage with Work Ethic, echo=FALSE}
# Creating a plot
eye_walk_we_plot <- ggplot(ootp, aes(x = Work.Ethic, y = Walk.Pct)) + 
  geom_boxplot(aes(fill = factor(ootp$Eye))) + 
  geom_smooth(method = lm) +
  # Labels
  labs(x = "Eye Rating", 
       y = "Walk Percentage", 
       title = "Scatterplot of Work Ethic vs. Walk Rate", 
       subtitle = "Each Eye Rating's distribution by work ethic is shown",
       fill = "Eye Rating")

eye_walk_we_plot

```



I noticed a fascinating trend right away with all 3 data sets seperated by Work Ethic. Initially, the relationship appeared to be linear. However, the medians and data now appear to be more exponential in nature, and might be worth exploring further with an exponential regression methodology. 

High work ethic really stabalized the data compared to Low and Normal. The data appears to have a more steady, consistent climb, with relatively consistent variation over the range of Eye ratings. 

Low work ethic appears to hurt players as the eye rating gets higher. I'd almost argue laziness can creep in a bit, as you can see the increasing trend slow and reverse to decreasing after 17 eye. Very few players appear to have an eye 
rating of > 17 at a low work ethic rating. 

Normal work ethic is a reasonably expected combination of looks from high and low. The data supports what appears a relatively consistent climb until the highest levels of data.

Incidentally, it might be worth considering removing the extreme values in further analysis due to the inconsistent nature of ratings higher than 17, and even lower than 4 or 5. 

***

## Multivariate Analysis

### Talk about some of the relationships you observed in this part of the
investigation. Were there features that strengthened each other in terms of
looking at your feature(s) of interest?

Summarizing the investigation of variables, I found that by including Work Ethic as a way to segment the relationships between Contact/Average and Eye/Walk % was shown to be potentially stronger based on the work ethic of a player. Further investigation is certainly warranted to consider this potential feature.

### Were there any interesting or surprising interactions between features?

I eluded to this earlier, but I was very surprised that the Eye/Walk % component almost appeared to be more of an exponential growth moreso than a linear one. 

The medians of the distribution of each contact ratings provided some 
interesting insight about the relationship between the variables.

### Did you create any models with your dataset?

Initially I did so with the bivariate data analysis. The model as written was medium strong, but it wasn't in my opinion up to par to make predictions as of yet with Average and Contact. However, I could put the Eye/Walk Pct model to use if I see fit. The correlation is pretty strong... but after investigating further, it lead to the potential of finding a better mathematical fit rather than linear. 

***

# Final Plots and Summary


### Plot One
```{r Plot_One, echo=FALSE}
war_plot
```

The first plot I chose, is the WAR of all 1675 batters in the dataset. The reason for this decision, is that ultimately, Baseball players are judged by a summary statistic if possible... and WAR is the best choice for that. This graph shows the distribution of all WAR ratings of all batters, and it shows that the data is skewed right, and offers up the idea that WAR does in fact make sense. WAR means wins above replacement... and most players who play in the bigs should in theory be better than the average replacement player. Most fall between 0 - 2 WAR. 

***

### Plot Two
```{r Plot_Two, echo=FALSE}
war_salary_plot
```

Next, I chose this scatterplot relating WAR to Salary. War matters for determining a player's quality as a catch-all, and they do play the game to get paid. It is a business as they say. Therefore, what better relationship to summarize and compare than WAR to salary. There wa sa tremendous amount of work that went into this, and I'd like to summarize why this was done this way. We 
needed to truly limit the amount of players chosen. Logically speaking, players who make the low amounts, be it the league minimum of $500,000 up to $5 Million, are going to be valuable players or not, but the salary won't really hurt the team in any way. To really gauge tha WAR vs. Salary value, we want to look at more expensive guys, compared to how well they performed. As we can see, some teams really got a great deal. There's a player who made a shade under $15 Million who was worth almost 9 WAR. On the flipside, there's a player who cost
$30 Million who was almost replacement level, just barely at 1 WAR. 

***

### Plot Three
```{r Plot_Three, echo=FALSE}
cont_avg_we_plot
```

Finally, I chose the Multivariate plot relating Work Ethic, Average, and Contact Rating as my final plot. Contact was the biggest driver of Average. Average in turn, is the best driver of WAR. Sticking with that theme, knowing 
how these relate have some value. I found the relationships interesting in this particular analysis, due to the fact that the segmented groups by Work Ethic really showed a differentiation to the consistency of a player. Particularly 
with a low work ethic rating, you can tell there's a significant amount of inconsistency in how a player hits the ball. This also gives me some thoughts about seeking a multi-variate regression problem, coupled with Avoid K, the 
other driver of Average to see if combined, they can bring more of a predictive variable to the table. 

***

# Reflection

As I worked on this project, I found it not only difficult to consider what to explore first, but to also determine the flow of the work that I chose to do. After revising my plots, and setting up the analysis components, I went back and tried to clean up the images and insights to better suit the theme of the EDA itself. 

I found that ultimately I found a flow to this process. I learned more about the
data set than I imagined I would, but I also found it quite intriguing how much more there could be to discover. As I answered questions about what each graph told me, it opened new ideas. For example, as I completed the Scatterplot with Contact vs. Average, it made me think about how Work Ethic relates to it. 

As I continue working on this dataset, there could be more things to explore. Further development of the relationships that weren't explored, or even fine tuning the relationships I did uncover. I'd like to also consider potentially different regression methodologies, and ultimately take this dataset into a machine learning environment, and train a model to predict the outcomes of player ratings with some confidence.